---
import { getRecentRepos, formatDate } from '../utils/github';

let repos = [];
let error = null;

try {
  repos = await getRecentRepos(12);
} catch (e) {
  error = 'Unable to load GitHub repositories';
  console.error(e);
}

function getLanguageColor(language) {
  const colors = {
    JavaScript: '#f1e05a',
    TypeScript: '#2b7489',
    Python: '#3572A5',
    Java: '#b07219',
    Go: '#00ADD8',
    Rust: '#dea584',
    Ruby: '#701516',
    PHP: '#4F5D95',
    C: '#555555',
    'C++': '#f34b7d',
    'C#': '#178600',
    Swift: '#ffac45',
    Kotlin: '#F18E33',
    Dart: '#00B4AB',
    Shell: '#89e051',
    HTML: '#e34c26',
    CSS: '#563d7c',
  };
  return colors[language] || '#858585';
}
---

<section id="github-repos" class="py-20 sm:py-32 px-4 sm:px-6 relative overflow-hidden">
  <!-- Background -->
  <div class="absolute inset-0 bg-linear-to-b from-slate-900 via-slate-950 to-slate-900"></div>
  
  <div class="max-w-6xl mx-auto relative z-10">
    <div class="text-center mb-12 sm:mb-16">
      <div class="inline-block mb-3 sm:mb-4">
        <span class="px-3 py-1.5 sm:px-4 sm:py-2 bg-emerald-500/10 border border-emerald-500/20 rounded-full text-emerald-400 text-xs sm:text-sm font-semibold backdrop-blur-sm flex items-center gap-2">
          <span class="relative flex h-2 w-2">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
          </span>
          Live from GitHub
        </span>
      </div>
      <h2 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-black text-white mb-4 sm:mb-6 tracking-tight px-4">
        Recent <span class="bg-clip-text text-transparent" style="background-image: radial-gradient(circle, #1e40af 0%, #3b82f6 50%, #60a5fa 100%);">Activity</span>
      </h2>
      <p class="text-base sm:text-lg md:text-xl text-slate-400 max-w-2xl mx-auto leading-relaxed px-4">
        Real-time feed from my GitHub â€¢ Swipe or use arrows to explore
      </p>
    </div>
    
    {error ? (
      <div class="text-center text-slate-400 py-12">
        <p>{error}</p>
      </div>
    ) : repos.length === 0 ? (
      <div class="text-center text-slate-400 py-12">
        <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"></div>
        <p class="mt-4">Loading repositories...</p>
      </div>
    ) : (
      <div class="record-player-wrapper">
        <!-- Carousel Container -->
        <div class="carousel-stage" id="carouselStage">
          {repos.map((repo, index) => {
            const CardWrapper = repo.private ? 'div' : 'a';
            const cardProps = repo.private 
              ? {} 
              : { href: repo.html_url, target: '_blank', rel: 'noopener noreferrer' };
            
            return (
              <CardWrapper 
                {...cardProps}
                class={`repo-card ${repo.private ? 'repo-card--private' : ''}`}
                data-index={index}
                data-repo-id={repo.id}
              >
                <div class="repo-card__inner">
                  {/* Header with badges */}
                  <div class="repo-card__header">
                    {repo.private && (
                      <span class="badge badge--private">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                        </svg>
                        Private
                      </span>
                    )}
                    {!repo.private && (
                      <svg class="repo-card__icon" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                      </svg>
                    )}
                  </div>

                  {/* Title */}
                  <h3 class="repo-card__title">{repo.name}</h3>

                  {/* Description */}
                  {repo.description && (
                    <p class="repo-card__description">{repo.description}</p>
                  )}

                  {/* Meta info */}
                  <div class="repo-card__meta">
                    {repo.language && (
                      <span class="meta-badge">
                        <span class="meta-badge__dot" style={`background-color: ${getLanguageColor(repo.language)};`}></span>
                        {repo.language}
                      </span>
                    )}
                    {repo.stargazers_count > 0 && (
                      <span class="meta-badge">
                        <svg class="w-3.5 h-3.5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                        </svg>
                        {repo.stargazers_count}
                      </span>
                    )}
                    {repo.forks_count > 0 && (
                      <span class="meta-badge">
                        <svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true">
                          <path d="M5 3.25a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm0 2.122a2.25 2.25 0 10-1.5 0v.878A2.25 2.25 0 005.75 8.5h1.5v2.128a2.251 2.251 0 101.5 0V8.5h1.5a2.25 2.25 0 002.25-2.25v-.878a2.25 2.25 0 10-1.5 0v.878a.75.75 0 01-.75.75h-4.5A.75.75 0 015 6.25v-.878zm3.75 7.378a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm3-8.75a.75.75 0 100-1.5.75.75 0 000 1.5z"></path>
                        </svg>
                        {repo.forks_count}
                      </span>
                    )}
                    <span class="meta-badge meta-badge--time">
                      <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                      </svg>
                      {formatDate(repo.updated_at)}
                    </span>
                  </div>

                  {/* Topics */}
                  {repo.topics && repo.topics.length > 0 && (
                    <div class="repo-card__topics">
                      {repo.topics.slice(0, 4).map((topic) => (
                        <span class="topic-pill">{topic}</span>
                      ))}
                    </div>
                  )}
                </div>
              </CardWrapper>
            );
          })}
        </div>

        <!-- Navigation Controls -->
        <div class="carousel-nav">
          <button 
            class="carousel-nav__btn carousel-nav__btn--prev" 
            id="prevBtn"
            aria-label="Previous repository"
          >
            <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M15 19l-7-7 7-7"></path>
            </svg>
          </button>
          
          <div class="carousel-nav__indicator" id="indicator">
            <span class="carousel-nav__current" id="currentIndex">1</span>
            <span class="carousel-nav__divider">/</span>
            <span class="carousel-nav__total">{repos.length}</span>
          </div>
          
          <button 
            class="carousel-nav__btn carousel-nav__btn--next" 
            id="nextBtn"
            aria-label="Next repository"
          >
            <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
        </div>
      </div>
    )}
    
    <!-- View All Button -->
    <div class="text-center mt-12 sm:mt-16">
      <a 
        href="https://github.com/Brandon255-rgb" 
        target="_blank" 
        rel="noopener noreferrer"
        class="inline-flex items-center gap-3 px-6 sm:px-8 py-3 sm:py-4 bg-slate-800/50 hover:bg-slate-700/50 border-[0.7px] border-blue-900/60 hover:border-emerald-500/50 text-white rounded-xl transition-all duration-300 backdrop-blur-xl group font-semibold text-sm sm:text-base"
      >
        <svg class="w-5 h-5 sm:w-6 sm:h-6 group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 24 24">
          <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
        </svg>
        <span>View All Repositories on GitHub</span>
        <svg class="w-4 h-4 sm:w-5 sm:h-5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
        </svg>
      </a>
    </div>
  </div>
</section>

<script>
  // Optimized carousel with GPU-accelerated transforms and passive listeners
  function initCarousel() {
    let currentIndex = 0;
    let isAnimating = false;
    
    const cards = document.querySelectorAll('.repo-card');
    const stage = document.getElementById('carouselStage');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const currentIndexEl = document.getElementById('currentIndex');
    const totalCards = cards.length;
    
    if (!cards.length || !stage) {
      console.log('Carousel elements not found');
      return;
    }
    
    console.log('Carousel initialized with', totalCards, 'cards');
    
    // Touch tracking
    let touchStartX = null;
    let touchStartY = null;
    let isDragging = false;

    function updateCarousel(direction = 'next') {
      if (isAnimating) {
        console.log('Animation blocked - already animating');
        return;
      }
      console.log('updateCarousel running, direction:', direction, 'currentIndex:', currentIndex);
      isAnimating = true;
      
      const prevCard = cards[currentIndex];
    
      // Animate out the previous card with dynamic flip and lift
      if (prevCard && direction !== 'init') {
        prevCard.classList.add('is-flipping-out');
        
        // Flip out animation - pick up, rotate and slide away
        prevCard.style.transition = 'transform 0.5s cubic-bezier(0.4, 0.0, 0.2, 1), opacity 0.4s ease';
        prevCard.style.transform = direction === 'next'
          ? 'translate(-150%, -80%) scale(0.8) rotateY(-45deg) rotateX(15deg) rotateZ(-8deg) translateZ(-100px)'
          : 'translate(150%, -80%) scale(0.8) rotateY(45deg) rotateX(15deg) rotateZ(8deg) translateZ(-100px)';
        prevCard.style.opacity = '0';
        prevCard.style.zIndex = '9';
      }
      
      // Use requestAnimationFrame for smooth 60fps updates
      requestAnimationFrame(() => {
        setTimeout(() => {
          cards.forEach((card, index) => {
            const offset = index - currentIndex;
            
            // Remove all state classes
            card.classList.remove('is-active', 'is-prev', 'is-next', 'is-hidden', 'is-flipping', 'is-flipping-out');
            card.setAttribute('aria-hidden', 'true');
            card.style.transition = 'transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.35s ease';
            
            if (offset === 0) {
              // Active card - dynamic flip in with bounce and life
              card.classList.add('is-active');
              card.classList.add('is-flipping');
              
              if (direction !== 'init') {
                // Start from rotated position (far back in space)
                card.style.transition = 'none';
                card.style.transform = direction === 'next'
                  ? 'translate(150%, -80%) scale(0.75) rotateY(50deg) rotateX(-20deg) rotateZ(10deg) translateZ(100px)'
                  : 'translate(-150%, -80%) scale(0.75) rotateY(-50deg) rotateX(-20deg) rotateZ(-10deg) translateZ(100px)';
                card.style.opacity = '0';
                card.style.zIndex = '10';
                
                // Animate to center with bounce and depth
                requestAnimationFrame(() => {
                  card.style.transition = 'transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.4s ease';
                  card.style.transform = 'translate(-50%, -50%) scale(1) rotateY(0deg) rotateX(0deg) rotateZ(0deg) translateZ(0px)';
                  card.style.opacity = '1';
                });
              } else {
                card.style.transform = 'translate(-50%, -50%) scale(1) rotateY(0deg) rotateX(0deg) rotateZ(0deg) translateZ(0px)';
                card.style.opacity = '1';
                card.style.zIndex = '10';
              }
              card.setAttribute('aria-hidden', 'false');
            } else if (offset === -1) {
              // Previous card - smooth depth recede
              card.classList.add('is-prev');
              card.style.transform = 'translate(-180%, -50%) scale(0.85) rotateY(20deg) rotateX(-5deg) translateZ(-30px)';
              card.style.opacity = '0.2';
              card.style.zIndex = '5';
            } else if (offset === 1) {
              // Next card - slide right with depth
              card.classList.add('is-next');
              card.style.transform = 'translate(80%, -50%) scale(0.85) rotateY(-20deg) rotateX(-5deg) translateZ(-30px)';
              card.style.opacity = '0.2';
              card.style.zIndex = '5';
            } else {
              // Hidden cards - far back with scale
              card.classList.add('is-hidden');
              card.style.transform = offset < 0 
                ? 'translate(-200%, -50%) scale(0.75) rotateY(35deg) translateZ(-60px)'
                : 'translate(100%, -50%) scale(0.75) rotateY(-35deg) translateZ(-60px)';
              card.style.opacity = '0';
              card.style.zIndex = '1';
            }
          });
          
          // Update indicator
          if (currentIndexEl) {
            currentIndexEl.textContent = String(currentIndex + 1);
          }
          
          // Update button states
          if (prevBtn) {
            prevBtn.disabled = currentIndex === 0;
            prevBtn.style.opacity = currentIndex === 0 ? '0.3' : '1';
          }
          if (nextBtn) {
            nextBtn.disabled = currentIndex === totalCards - 1;
            nextBtn.style.opacity = currentIndex === totalCards - 1 ? '0.3' : '1';
          }
        }, direction !== 'init' ? 100 : 0);
        
        setTimeout(() => {
          isAnimating = false;
        }, direction !== 'init' ? 550 : 0);
      });
    }

    function goToNext() {
      console.log('goToNext called, currentIndex:', currentIndex);
      if (isAnimating || currentIndex >= totalCards - 1) return;
      currentIndex++;
      updateCarousel('next');
    }

    function goToPrev() {
      console.log('goToPrev called, currentIndex:', currentIndex);
      if (isAnimating || currentIndex <= 0) return;
      currentIndex--;
      updateCarousel('prev');
    }

    // Button navigation
    prevBtn?.addEventListener('click', () => {
      console.log('Prev button clicked');
      goToPrev();
    });
    nextBtn?.addEventListener('click', () => {
      console.log('Next button clicked');
      goToNext();
    });

    // Keyboard navigation - only when focused
    let keyboardEnabled = true;
    document.addEventListener('keydown', (e) => {
      if (!keyboardEnabled) return;
      
      if (e.key === 'ArrowLeft' || e.key === 'Left') {
        e.preventDefault();
        goToPrev();
      } else if (e.key === 'ArrowRight' || e.key === 'Right') {
        e.preventDefault();
        goToNext();
      }
    });

    // Touch/swipe - mobile optimized
    stage?.addEventListener('touchstart', (e) => {
      touchStartX = e.touches[0].clientX;
      touchStartY = e.touches[0].clientY;
      isDragging = false;
    }, { passive: true });

    stage?.addEventListener('touchmove', (e) => {
      if (touchStartX === null || touchStartY === null) return;
      
      const deltaX = e.touches[0].clientX - touchStartX;
      const deltaY = e.touches[0].clientY - touchStartY;
      
      // Detect horizontal swipe vs vertical scroll
      if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 10) {
        isDragging = true;
      }
    }, { passive: true });

    stage?.addEventListener('touchend', (e) => {
      if (touchStartX === null || !isDragging) {
        touchStartX = null;
        touchStartY = null;
        isDragging = false;
        return;
      }
      
      const touchEndX = e.changedTouches[0].clientX;
      const deltaX = touchEndX - touchStartX;
      const threshold = 50; // Minimum swipe distance in px
      
      if (Math.abs(deltaX) > threshold) {
        if (deltaX > 0) {
          goToPrev();
        } else {
          goToNext();
        }
      }
      
      touchStartX = null;
      touchStartY = null;
      isDragging = false;
    }, { passive: true });

    // Initialize
    updateCarousel('init');

    // Preconnect hint for better performance
    if ('connection' in navigator) {
      const effectiveType = navigator.connection?.effectiveType;
      if (effectiveType && effectiveType.includes('2g')) {
        // Reduce animations on slow connections
        cards.forEach(card => {
          card.style.transition = 'transform 0.2s ease, opacity 0.2s ease';
        });
      }
    }
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initCarousel);
  } else {
    initCarousel();
  }
</script>

<style>
  /* Mobile-first, performance-optimized carousel */
  .record-player-wrapper {
    position: relative;
    width: 100%;
    max-width: 100%;
    margin: 0 auto;
    padding: 1rem 0 2rem;
  }

  /* Carousel stage - GPU-accelerated with enhanced depth */
  .carousel-stage {
    position: relative;
    width: 100%;
    height: 380px;
    display: flex;
    align-items: center;
    justify-content: center;
    contain: layout style paint;
    touch-action: pan-y pinch-zoom;
    perspective: 2000px;
    transform-style: preserve-3d;
    transform: perspective(2000px) rotateX(0deg);
  }

  /* Individual repo card */
  .repo-card {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: calc(100% - 2rem);
    max-width: 340px;
    min-height: 320px;
    will-change: transform, opacity;
    transition: transform 0.45s cubic-bezier(0.34, 1.56, 0.64, 1), 
                opacity 0.35s ease;
    pointer-events: none;
    cursor: default;
    transform-style: preserve-3d;
    perspective: 1000px;
  }
  
  /* Flipping animation state */
  .repo-card.is-flipping {
    transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1), 
                opacity 0.4s ease;
  }
  
  .repo-card.is-flipping-out {
    transition: transform 0.5s cubic-bezier(0.4, 0.0, 0.2, 1), 
                opacity 0.4s ease;
  }

  /* Public repos are links */
  .repo-card:not(.repo-card--private) {
    cursor: pointer;
    pointer-events: auto;
  }

  /* Active card state */
  .repo-card.is-active {
    pointer-events: auto;
    z-index: 10;
  }

  /* Private repo - no pointer interaction */
  .repo-card--private {
    cursor: default;
  }
  
  .repo-card--private:hover .repo-card__inner {
    transform: none;
    box-shadow: 0 12px 40px -8px rgba(2, 6, 23, 0.5);
  }

  /* Card inner container */
  .repo-card__inner {
    position: relative;
    width: 100%;
    height: 100%;
    padding: 1.25rem;
    background: linear-gradient(145deg, 
      rgba(15, 23, 42, 0.95) 0%, 
      rgba(2, 6, 23, 0.9) 100%);
    border: 1px solid rgba(100, 116, 139, 0.15);
    border-radius: 1.25rem;
    box-shadow: 0 12px 40px -8px rgba(2, 6, 23, 0.5);
    backdrop-filter: blur(12px);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    contain: layout style paint;
  }

  .repo-card:not(.repo-card--private):hover .repo-card__inner {
    transform: translateY(-2px);
    box-shadow: 0 16px 50px -10px rgba(16, 185, 129, 0.15),
                0 12px 40px -8px rgba(2, 6, 23, 0.6);
  }

  /* Header with badges */
  .repo-card__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.5rem;
    margin-bottom: 0.25rem;
  }

  .repo-card__icon {
    width: 1.75rem;
    height: 1.75rem;
    color: #64748b;
    flex-shrink: 0;
  }

  /* Badge styles */
  .badge {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.375rem 0.625rem;
    font-size: 0.75rem;
    font-weight: 600;
    border-radius: 0.5rem;
    line-height: 1;
  }

  .badge--private {
    background: rgba(245, 158, 11, 0.15);
    border: 1px solid rgba(245, 158, 11, 0.3);
    color: #fbbf24;
  }

  /* Title */
  .repo-card__title {
    font-size: 1.125rem;
    font-weight: 800;
    color: #f1f5f9;
    line-height: 1.3;
    margin: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  /* Description */
  .repo-card__description {
    font-size: 0.875rem;
    line-height: 1.5;
    color: #cbd5e1;
    margin: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    flex: 1;
  }

  /* Meta badges */
  .repo-card__meta {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    align-items: center;
    margin-top: auto;
  }

  .meta-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.25rem 0.625rem;
    background: rgba(100, 116, 139, 0.1);
    border: 1px solid rgba(100, 116, 139, 0.15);
    border-radius: 0.5rem;
    font-size: 0.75rem;
    font-weight: 500;
    color: #cbd5e1;
    line-height: 1;
  }

  .meta-badge__dot {
    width: 0.5rem;
    height: 0.5rem;
    border-radius: 50%;
    flex-shrink: 0;
  }

  .meta-badge--time {
    background: rgba(16, 185, 129, 0.08);
    border-color: rgba(16, 185, 129, 0.2);
    color: #6ee7b7;
  }

  /* Topics */
  .repo-card__topics {
    display: flex;
    flex-wrap: wrap;
    gap: 0.375rem;
  }

  .topic-pill {
    padding: 0.25rem 0.625rem;
    background: rgba(59, 130, 246, 0.1);
    border: 1px solid rgba(59, 130, 246, 0.2);
    border-radius: 0.5rem;
    font-size: 0.7rem;
    font-weight: 500;
    color: #93c5fd;
    line-height: 1;
  }

  /* Navigation controls */
  .carousel-nav {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    margin-top: 1.5rem;
    padding: 0 1rem;
  }

  .carousel-nav__btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    padding: 0;
    background: rgba(15, 23, 42, 0.7);
    border: 1px solid rgba(100, 116, 139, 0.2);
    border-radius: 50%;
    color: #cbd5e1;
    cursor: pointer;
    transition: all 0.2s ease;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }

  .carousel-nav__btn:hover:not(:disabled) {
    background: rgba(16, 185, 129, 0.15);
    border-color: rgba(16, 185, 129, 0.3);
    color: #10b981;
    transform: scale(1.05);
  }

  .carousel-nav__btn:active:not(:disabled) {
    transform: scale(0.95);
  }

  .carousel-nav__btn:disabled {
    cursor: not-allowed;
    opacity: 0.3;
  }

  .carousel-nav__indicator {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.5rem 1rem;
    background: rgba(15, 23, 42, 0.6);
    border: 1px solid rgba(100, 116, 139, 0.15);
    border-radius: 2rem;
    font-size: 0.875rem;
    font-weight: 600;
    color: #e2e8f0;
    backdrop-filter: blur(8px);
  }

  .carousel-nav__current {
    color: #10b981;
    font-weight: 700;
  }

  .carousel-nav__divider {
    color: #64748b;
  }

  .carousel-nav__total {
    color: #94a3b8;
  }

  /* Tablet and up */
  @media (min-width: 640px) {
    .carousel-stage {
      height: 420px;
    }

    .repo-card {
      max-width: 400px;
      min-height: 360px;
    }

    .repo-card__inner {
      padding: 1.5rem;
      gap: 1rem;
    }

    .repo-card__title {
      font-size: 1.25rem;
    }

    .repo-card__description {
      font-size: 0.9375rem;
    }

    .carousel-nav__btn {
      width: 3rem;
      height: 3rem;
    }
  }

  /* Desktop and up */
  @media (min-width: 1024px) {
    .record-player-wrapper {
      padding: 2rem 0 3rem;
    }

    .carousel-stage {
      height: 440px;
    }

    .repo-card {
      max-width: 460px;
      min-height: 380px;
    }

    .carousel-nav {
      gap: 1.5rem;
      margin-top: 2rem;
    }
  }

  /* Reduced motion preference */
  @media (prefers-reduced-motion: reduce) {
    .repo-card,
    .repo-card__inner,
    .carousel-nav__btn {
      transition-duration: 0.01ms !important;
    }
  }

  /* High contrast mode */
  @media (prefers-contrast: high) {
    .repo-card__inner {
      border-width: 2px;
      border-color: rgba(100, 116, 139, 0.4);
    }

    .badge,
    .meta-badge,
    .topic-pill {
      border-width: 1.5px;
    }
  }
</style>
